# 🎯 同値分割法 理論学習・基本演習

## 📚 同値分割の理論基盤

### 🔍 同値分割の数学的基礎

#### 📊 集合論との関係
**同値関係**: 入力領域Dにおいて、以下3つの性質を満たす関係R
- **反射律**: 任意のx∈Dに対してxRx
- **対称律**: xRy ⟹ yRx  
- **推移律**: xRy ∧ yRz ⟹ xRz

**同値クラス**: 同値関係Rによって分割されたDの部分集合

#### 🎯 テストにおける同値関係
**定義**: 2つの入力値が「同じ処理結果を生成する」関係

**例**: パスワード長チェック機能
- 入力値 "abc"(3文字) と "xyz"(3文字) → 同じエラーメッセージ
- 入力値 "password123"(11文字) と "mypassword"(10文字) → 同じ正常処理

### 📋 同値分割の手順

#### 🔄 標準手順（5ステップ）

##### 1️⃣ **仕様分析・条件抽出**
- 入力項目の特定
- 制約条件の抽出
- 処理分岐の把握

##### 2️⃣ **有効同値クラス特定**
- 正常処理される入力範囲
- ビジネスルールに適合する値域

##### 3️⃣ **無効同値クラス特定**  
- エラー処理される入力範囲
- 制約違反・異常値

##### 4️⃣ **代表値選択**
- 各クラスから典型的な値を選択
- テスト実行可能な具体値

##### 5️⃣ **テストケース作成**
- 入力値・期待結果の文書化
- 実行手順の明記

## 🛠️ 基本演習1: ECサイト年齢入力

### 📋 演習仕様
**機能**: 会員登録時の年齢入力チェック
**制約**: 
- 18歳以上65歳以下のみ登録可能
- 整数値のみ受付
- 未入力は拒否

### 🔍 手順1: 仕様分析

#### 📊 条件抽出
- **入力項目**: 年齢（整数）
- **有効範囲**: 18 ≤ 年齢 ≤ 65
- **処理分岐**: 
  - 18-65: 「登録完了」
  - その他: 「年齢制限エラー」
  - 未入力: 「必須入力エラー」

### 🔍 手順2-3: 同値クラス特定

#### ✅ 有効同値クラス
- **EC1**: 18以上65以下の整数

#### ❌ 無効同値クラス  
- **EC2**: 17以下の整数
- **EC3**: 66以上の整数
- **EC4**: 未入力（null、空文字）
- **EC5**: 非整数（小数、文字列など）

### 🔍 手順4: 代表値選択

| 同値クラス | 代表値 | 選択理由 |
|------------|--------|----------|
| EC1（有効） | 30 | 範囲中央の典型値 |
| EC2（無効） | 10 | 明確な下限違反 |
| EC3（無効） | 70 | 明確な上限違反 |
| EC4（無効） | "" | 空文字（未入力） |
| EC5（無効） | "abc" | 文字列（型違反） |

### 🔍 手順5: テストケース作成

| ID | 入力値 | 期待結果 | 同値クラス |
|----|--------|----------|-----------|
| TC001 | 30 | 登録完了 | EC1 |
| TC002 | 10 | 年齢制限エラー | EC2 |
| TC003 | 70 | 年齢制限エラー | EC3 |
| TC004 | "" | 必須入力エラー | EC4 |
| TC005 | "abc" | 入力形式エラー | EC5 |

## 🛠️ 基本演習2: 割引率計算

### 📋 演習仕様
**機能**: 購入金額に応じた割引率計算
**制約**:
- 1,000円未満: 割引なし（0%）
- 1,000円以上10,000円未満: 5%割引
- 10,000円以上50,000円未満: 10%割引  
- 50,000円以上: 15%割引
- 負数・非数値は拒否

### 🔍 あなたの解答を考えてみましょう

#### 📝 練習問題
以下を自分で考えてから、解答例を確認してください：

1. **同値クラス特定**:
   - 有効同値クラスを列挙
   - 無効同値クラスを列挙

2. **代表値選択**:
   - 各クラスの代表値を決定
   - 選択理由を説明

3. **テストケース作成**:
   - ID、入力値、期待結果の表作成

### ✅ 解答例

#### 📊 同値クラス特定
**有効同値クラス**:
- **EC1**: 0 ≤ 金額 < 1,000 → 0%割引
- **EC2**: 1,000 ≤ 金額 < 10,000 → 5%割引
- **EC3**: 10,000 ≤ 金額 < 50,000 → 10%割引
- **EC4**: 50,000 ≤ 金額 → 15%割引

**無効同値クラス**:
- **EC5**: 負数
- **EC6**: 非数値

#### 📊 代表値選択・テストケース

| ID | 入力値 | 期待結果 | 同値クラス | 選択理由 |
|----|--------|----------|-----------|----------|
| TC001 | 500 | 0%割引 | EC1 | 範囲内典型値 |
| TC002 | 5000 | 5%割引 | EC2 | 範囲内典型値 |
| TC003 | 25000 | 10%割引 | EC3 | 範囲内典型値 |
| TC004 | 100000 | 15%割引 | EC4 | 上限なし範囲 |
| TC005 | -100 | エラー | EC5 | 負数 |
| TC006 | "abc" | エラー | EC6 | 文字列 |

## 🎯 同値分割の重要ポイント

### ✅ 正しい適用のポイント

#### 🔍 同値クラス特定のコツ
1. **仕様書の条件文に注目**: if文、case文の条件
2. **数値範囲の境界を意識**: 以上・以下・未満・超過
3. **データ型制約を考慮**: 文字列・数値・日付等
4. **ビジネスルールを反映**: 業務上の制約事項

#### 🎯 代表値選択のガイドライン
1. **典型値優先**: クラス内で最も自然な値
2. **実装可能性**: テスト実行できる具体値
3. **明確性**: 他クラスとの区別が明確
4. **再現性**: 同じ結果が得られる値

### ❌ よくある間違い

#### 🚫 同値クラス特定の間違い
- **境界値含有**: 境界値を同値クラスに含める
- **過細分化**: 不必要に細かく分割
- **条件見落とし**: 隠れた制約の無視

#### 🚫 代表値選択の間違い
- **境界値選択**: 境界値を代表値として選ぶ
- **複数値選択**: 1つのクラスから複数の代表値
- **非現実値**: 実際には発生しない値

## 🛠️ 基本演習3: パスワード強度チェック

### 📋 演習仕様
**機能**: パスワード強度判定
**制約**:
- 長さ: 8文字以上16文字以下
- 文字種: 英数字のみ
- 必須条件: 大文字・小文字・数字を各1文字以上含む
- 強度判定:
  - 全条件満たす: 「強」
  - 長さOK + 文字種一部不足: 「中」  
  - 長さNG: 「弱」

### 📝 自分で解いてみましょう

この演習は複雑な条件です。以下の手順で進めてください：

1. **条件分析**: 複数の制約を整理
2. **クラス特定**: 条件の組み合わせを考慮
3. **代表値選択**: 実際のパスワード例を設定
4. **検証**: 作成したテストケースの妥当性確認

### 💡 ヒント
- 複数条件の組み合わせでは、条件ごとに分けて考える
- 文字種条件は組み合わせが多いので注意
- 実際に使いそうなパスワード例を考える

## 📊 学習確認問題

### 🎯 理解度チェック

#### 📝 問題1: 概念確認
以下の説明で正しいものを選んでください：

A) 同値分割では境界値を重点的にテストする  
B) 1つの同値クラスから複数の代表値を選ぶべきである
C) 同値クラス内の値は同じ処理結果を生成する
D) 有効同値クラスのテストのみで十分である

#### 📝 問題2: 適用場面判定
同値分割の適用が適切でない場面は？

A) 商品価格による送料計算  
B) 複数条件の組み合わせ判定
C) ユーザー権限による機能制限
D) 入力文字数制限チェック

#### 📝 問題3: 実践問題
**仕様**: 成績評価（A,B,C,D,F）
- 90点以上: A
- 80-89点: B  
- 70-79点: C
- 60-69点: D
- 60点未満: F

同値クラス数と代表値を答えてください。

### ✅ 解答

#### 🎯 問題1解答: C
**解説**: 同値分割の基本定義です。A)は境界値分析、B)は1クラス1代表値の原則違反、D)は無効同値クラスのテストも重要です。

#### 🎯 問題2解答: B  
**解説**: 複雑な条件組み合わせはデシジョンテーブルが適しています。

#### 🎯 問題3解答:
**同値クラス**: 5個（各評価に対応）
**代表値例**: 95(A), 85(B), 75(C), 65(D), 50(F)

## 🎯 次回学習への準備

### 📚 今回で習得したスキル
- 同値分割の基本手順
- 同値クラス特定方法
- 代表値選択技術
- 基本的なテストケース作成

### 🔍 理解度自己評価
以下の項目で自己評価してください（1-5点）：

- [ ] 同値分割の手順理解: __/5点
- [ ] 同値クラス特定スキル: __/5点  
- [ ] 代表値選択スキル: __/5点
- [ ] テストケース作成スキル: __/5点

### 🚀 次のステップ
**03_習得レベル確認.md**で学習成果を測定し、実務適用レベルへの到達度を確認します。

### 📝 学習記録

```
【同値分割学習記録 - 理論学習・基本演習】
日時: YYYY/MM/DD
学習時間: XX分

## 習得できた内容
- 

## 理解困難だった点
- 

## 実務で適用したい場面
- 

## 次回学習での重点確認項目
- 
```